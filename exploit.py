from Crypto.Util.number import long_to_bytes, bytes_to_long
from gmpy2 import mpz, to_binary, from_binary

def get_encrypted_flag(filename="flag_enc"):
    encryptedflag = ""
    with open(filename) as f:
        for line in f.readline():
            encryptedflag+=line
        
    print(encryptedflag)
    return encryptedflag

ALPHABET = bytearray(b"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ#")

def base_n_decode(bytes_in, base):
    bytes_out = to_binary(mpz(bytes_in, base=base))[:1:-1]
    return bytes_out

def decrypt(flag, key):
    out = flag
    for i in key:
        out = base_n_decode(out, ALPHABET.index(i))
    return out

def main():
    print("[+] Parsing Flag")
    for i in range(0, 200000000):
        flag = get_encrypted_flag()
        decryptedflag = decrypt(flag, str(i))
        print(flag)
main()
